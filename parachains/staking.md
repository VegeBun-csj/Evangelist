# Staking
波卡使用NPOS(Nominated proof-of-stake)作为其共识机制。系统鼓励DOT持有者去参与成为提名人。提名人最多可以选择16个验证人作为受信任的验证人候选者。验证人和提名人都会将他们的代币锁定作为抵押，并接收质押奖励。

整个质押系统基本上在不考虑质押的情况会平等地向所有验证人支付奖励。在一个验证人上投入更多质押并不会影响它收到的块奖励的数量。然而，奖励计算存在概率成分，所以在特定时间段，奖励对于所有的验证人可能不完全相同。

在扣除验证人的基本质押金额后，奖励会按比例分配给所有的质押参与者。通过这种方式，网络为具有较低质押金额的验证人创造了提名激励，从而创建一个平等质押的验证人集合。

## 波卡中的质押是如何工作的？
### 1.确定你是哪种角色
在质押中，你可以是[提名人或者是验证人](https://wiki.polkadot.network/zh-CN/docs/learn-staking#validators-and-nominators)   
作为一个提名人，你可以提名验证人候选者，也就是你信任可以帮助你赚取链的原生代币的一个角色。赚取的奖励可以立即绑定(锁定)在您的帐户进行质押，也就是说随着时间的推移，你可以有效地复用你所获得的奖励。你也可以选择将奖励存储到你的账户，或者是另一个账户作为可用(可转移)余额。你可以参考[提名人指南](https://wiki.polkadot.network/zh-CN/docs/learn-nominator)来理解作为一个提名人的职责，以及[验证人文档](https://wiki.polkadot.network/zh-CN/docs/learn-validator)来了解需要做什么才能成为一个验证人。

如果你是一个新手并且想要通过Polkadpt JS APP安全地质押你的代币，可以看下面的视频
<iframe width="560" height="315" src="https://www.youtube.com/embed/FCXC0CDhyS4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

### 2.质押系统概述
任何一个潜在的验证人都会想他们成为一个验证人候选者。系统中的候选人会向所有提名人公开，而提名人则提交其支持的最多16名候选人的名单。在下一个阶段，一定数量的拥有最多DOT支持的验证人会被选中并活跃起来。作为一个提名人，最少需要10个DOT来提交提名意向。提名意向被放在一个半排序的列表中，称为[“包列表(bag-list)”](https://github.com/paritytech/substrate/pull/9507)。包列表有两个主要组件，包和节点。列表由包组成，每个包都描述了一系列活跃的绑定的资产(例如，第一个包会有0->10 DOT的提名人，第二个包会有11->20DOT的提名人，等等)。每个包中是一个节点列表，对应于一个提名人以及他们的质押资产。

bag-list这个pallet被设计为自我维护的，只需区块链付出最少的代价，就能使其具有极大的可伸缩性。让我们通过一个示例来探讨包列表的排序功能。在下面的包列表中，3个包中放置了8个节点。可以观察到，包内的节点列表是根据它们的插入顺序排列的，而不是基于绑定的代币数量。例如，包1中的节点是这样排列的:15->12->19

![baglist](https://cdn.jsdelivr.net/gh/VegeBun-csj/Images/801652109515_.pic.jpg)

假设提名人持有19个DOT，绑定2个DOT。这个操作会把这个提名人节点放在袋2中，就在DOT为27的节点之后。
> Info    
诸如绑定/解绑定代币之类的动作会自动重新组装包节点，但是诸如质押奖励/S销毁之类的事件却没有！Bags-List这个pallet拥有一个重要的无许可外部外部调用：`Rebag`。这使任何人都可以指定错误的袋子中的另一个帐户，然后将其放入正确的帐户中。检查袋子列表部分以获取更多信息。

![baglist](https://cdn.jsdelivr.net/gh/VegeBun-csj/Images/931652780320_.pic.jpg)

这种分类功能对于质押/选举系统的[长期改进](https://gist.github.com/kianenigma/aa835946455b9a3f167821b9d05ba376)非常重要。Bags-List能够包含无限数量的节点，但要遵守链的运行时存储。在当前的质押系统配置中，包列表保留了50000个提名意向，其中22,500名作为选举提名人出现。查看[订阅选举阶段](https://wiki.polkadot.network/docs/learn-nominator#staking-election-stages)部分以获取更多信息。

> 获得奖励的最少活跃提名阈值
提交提名意向并不能确保获得奖励。前22,500个提名人的质押会应用于验证人活跃的集合中。为了确保能够获得质押奖励，确保被绑定的代币数量高于最低活跃提名。有关更多信息，请查看[提名人指南](https://wiki.polkadot.network/docs/learn-nominator)

提名期结束后，NPOS选举机制会以提名意向及相关投票作为输入，并输出一组验证人。包被从最多的质押到最少的质押进行迭代。这可能会让最后一个接触到的包只被部分迭代。这意味着在某些边界情况下，包内成员的顺序也很重要。回想一下，在每个包中，迭代顺序就是插入顺序。如果只有7个节点被选为选择集，那么拥有5和7个点的节点将被选中，拥有8个点的节点将会被忽略。bag-list pallet附带一个外部变量:`putInFrontOf`，它帮助节点在包中向前移动。有关更多信息，请查看[bag-list](https://wiki.polkadot.network/docs/learn-nominator#bags-list)部分。

![baglist](https://cdn.jsdelivr.net/gh/VegeBun-csj/Images/941652789684_.pic.jpg)

“选举解决方案”必须满足某些要求，例如最大化提名验证人的权质押额，尽可能均匀地分配支持验证者的质押。这种选举机制的目标是最大限度地提高网络的安全性，并实现候选人的公平代表。如果你想了解更多关于NPOS的工作原理(例如选举、运行时间复杂性等)，请阅读[这里](http://research.web3.foundation/en/latest/polkadot/NPoS.html)。    
我们希望每个提名者仔细跟踪他们支持的验证者的表现和声誉。提名不是一种“设定好就忘掉”的操作。 

### 3.质押奖励分配
为了解释奖励是如何支付给验证人和提名人的，我们需要考虑验证人池。验证人池由被选出的验证人的质押以及支持它的提名人组成。

如果一个提名人`n`用质押金额`s`支持几个被选举的验证人,k的意思就是，NPOS选举机制将其质押金额分割成块`s_1`,`s_2`,.......,`s_k`,所以它支持验证人i的质押金额为`s_i`。在这种情况下,如果这k个提名人在不同的池,每一个支持一个验证人`i`的质押金额为`s_i`，那么提名人`n`就收到相同的奖励。

对于每个验证人池，我们保留一个带有相关质押金额的提名人列表。

跨验证人池的奖励的一般规则是，两个验证人池在相同的工作中获得本质上相同数量的代币，也就是说，它们的报酬不是与每个验证人池中的质押成比例。以[era分数](https://wiki.polkadot.network/docs/maintain-guides-validator-payout##era-points)和[小费](https://wiki.polkadot.network/docs/learn-transaction-fees#fee-calculation)的形式质押的奖励存在概率成分，但这些成分应该随着时间的推移而平均化。

在一个验证器人中，一定比例(可配置)的奖励将支付给验证人提交区块的费用，其余的将按比例(即按质押比例)支付给提名人和验证人。特别要注意的是，验证人会得到两次奖励:一次是来自验证的提交区块的佣金(如果他们的佣金率高于0%)，一次是来自提名自己的质押。如果验证人的佣金设置为100%，那么将不会向其验证人池中的任何提名人支付代币奖励。

为了评估通货膨胀率,以及每个月你作为提名人或验证人可以得到多少代币,您可以使用这个[工具](https://www.stakingrewards.com/earn/polkadot/calculate)作为参考,它通过改变一些参数(如你想质押多少天DOT,费用,复合奖励,等等)得到一个更好的估算。尽管它可能不完全准确，因为质押人的参与是动态变化的，但它是一个很好的指标。

### 4.奖励机制
我们强调了这个支付方案的两个特点。第一个是，由于验证人池的报酬与质押水平无关，因此质押较少的池通常会比质押较多的池向每个代币的提名人支付更多的报酬。

因此，我们为提名人提供经济激励，使他们逐渐将偏好转向获得足够声誉的风险较小的验证人。这样做的原因是，我们希望跨验证器池的质押尽可能均匀地分布，以避免权力集中在少数几个验证人手中。

从长期来看，我们预计所有验证人池都有类似的质押水平，声誉越高的验证人的利益越高(这意味着提名人愿意冒更大的风险，支持声誉较低的验证人，以获得更多的报酬)。   

下面的示例应能阐明上述内容。为了简单起见，我们有以下假设：
- 这些验证人没有自己的质押。
- 他们每个人都有相同数量的era分数。
- 任何交易都没有消费。
- 他们不收取任何提交区块的奖励。
- 总奖励金额为100个DOT代币。
- 当前作为验证人的最小DOT数量是350(注意，这不是实际的值，它是波动的，而仅仅是本例的一个假设;要了解实际最小赌注是如何计算的，请参阅[这里](https://wiki.polkadot.network/docs/faq#what-is-the-minimum-stake-necessary-to-be-elected-as-an-active-validator)。

|   | **A-Validator** |  |   |
| :-----| ----: | :----: |  :----: |
| Nomnation(4) | Stake(600) | Fraction of the Total Stake | Rewards |
| Jin | 100 | 0.167 | 16.7 |
| **Sam** | 50 | 0.083 | 8.3 |
| Anson | 250 | 0.417 | 41.7 |
| Bobby | 200 | 0.333 | 33.3 |

|   | **B-Validator** |  |   |
| :-----| ----: | :----: |  :----: |
| Nomnation(4) | Stake(400) | Fraction of the Total Stake | Rewards |
| Alice | 100 | 0.25 | 25 |
| Peter | 100 | 0.25 | 25 |
| John | 150 | 0.375 | 37.5 |
| **Kitty** | 50 | 0.125 | 12.5 |

两个验证人池A和B都有4个提名人，总质押分别为600和400。

基于上述奖励分配，在验证人池B中的提名人每个DOT比在池A中的提名人获得更多奖励，因为池A拥有更多的总质押。Sam在池A中质押了50 DOT，但他只能得到8.3，而Kitty以同样的质押获得了12.5。

关于奖励，还有一个额外的因素需要考虑。虽然一个验证人可以拥有的提名人的数量没有限制，但验证人可以支付奖励的提名人的数量是有限制的。

在Polkadot和Kusama，这个限制目前是256，尽管这可以通过Runtime升级修改。超过256个提名者的验证器是超额订阅的。当支付发生时，只有前256名的提名人(以分配给验证人的质押数量衡量)将获得奖励。所有其他提名人本质上都是在“浪费”他们的质押——他们用自己的提名来选举那个验证者成为活跃的收集人，但却没有因此获得回报。

我们还注意到，当网络因为一个错误行为(例如验证器离线，模棱两可等)而削减验证人槽时，削减的金额是一个固定的百分比(而不是一个固定的金额)，这意味着拥有更多质押金额的验证人池将被削减更多的DOT。，这样做是为了给提名人提供一种经济激励，让他们改变自己的偏好，支持他们认为值得信任的、不那么受欢迎的验证者。

需要注意的第二点是，每个验证人候选者都可以自由指定他们想要的提交区块佣金(作为奖励的百分比)，以弥补运营成本。由于验证池的报酬相同，佣金较低的池比费用较高的池向提名人支付更多的费用。因此，每个验证人可以选择提高他们的费用来赚取更多，或降低他们的费用来吸引更多的提名人，以增加他们被选上的机会。从长远来看，我们期望所有的验证人都需要具有成本效率以保持竞争力，并要求验证人具有较高的声誉

## 账户
有两个不同的账户来管理你的资金:`存储账户`和`控制者账户`。

![stash and controller](https://cdn.jsdelivr.net/gh/VegeBun-csj/Images/account.png)

- 存储账户：该帐户持有用于质押的绑定资金，但将一些功能委托给了控制者账户。因此，你可能会通过一个藏在冷钱包的密钥积极参与，这意味着它一直处于离线状态。您还可以指定一个代理帐户来对[治理](https://wiki.polkadot.network/docs/learn-governance)提案进行投票。

- 控制者账户：该帐户代表存储帐户，发出关于提名和验证的决定。它设定了支付账户和提交支付等偏好。如果您是一个验证人，它还可以设置[会话密钥](https://wiki.polkadot.network/docs/learn-keys#session-keys)。它只需要足够的资金支付交易费用。

我们设计了这种分离密钥类型的层次结构，以便验证人操作者和提名人能够比只有一个密钥的系统更好地保护自己。通常，只要您将一个密钥用于多个角色，或者即使您使用与派生相关的密钥，您就会失去安全性。你不应该使用任何帐户密钥作为特别的“热”会话密钥。

控制者账户和存储帐户密钥可以是sr25519或ed25519。有关Polkadot中如何使用密钥及其背后的密码学的更多信息，请[参见这里](https://wiki.polkadot.network/docs/learn-keys)。

## 验证人和提名人
由于验证人的名额是有限的，大多数的验证人是需要质押DOT并为网络经济安全做出贡献的人才会被提名。

验证人会完成大部分繁重的工作:它们会在BABE中产生新的候选区块，在GRANDPA中投票并达成共识，验证平行链的状态转换功能，可能还负责其他一些有关数据可用性和XCM的职责。

另一方面，提名人的责任要少得多。包括监控验证人的性能(正常运行时间)，关注不断变化的佣金率(验证人可以在任何时候更改区块佣金)，以及对其及其验证人帐户的一般健康状况进行监控。因此，与验证人相比，提名人的经验是相对不干涉的，而不是一定了事。
![validator and nomination](https://cdn.jsdelivr.net/gh/VegeBun-csj/Images/1011653814345_.pic.jpg)

### 想要质押DOT？
* [提名人指南](https://wiki.polkadot.network/docs/maintain-guides-how-to-nominate-polkadot) 成为波卡网络上的提名人
* [验证人指南](https://wiki.polkadot.network/docs/maintain-guides-how-to-validate-polkadot) 成为波卡网络上的验证人

## 削减
如果网络中的验证人有不当行为（例如，脱机，攻击网络或运行修改的软件），就会发生削减。验证人和他们的提名人会因此失去一定比例的绑定资金/质押金额。

任何被削减的DOT都将被纳入[国库](https://wiki.polkadot.network/docs/learn-treasury)。这样做的理由(而不是将其销毁或作为奖励分发)是，理事会只需从国库进行支付就可以恢复削减。这在一些情况下非常有用，比如运行时错误导致大幅削减，或者由于本身没有错误而迫使验证人离线。在合法削减的情况下，这种机制可以将代币从恶意验证人转移到那些通过正常的国库流程构建生态系统的人。

与不太受欢迎的验证人相比，支持它们的验证人池将受到更严厉的削减，所以我们鼓励提名人将他们的提名转移到不太受欢迎的验证人，以减少他们可能的损失。

重要的是要认识到，削减只发生在给定提名人的活跃的验证中，而削减不会因为有其他不活跃或等待的提名而减轻。它们也不能通过运行单独的验证人来缓解;每个验证人都被认为是自己的实体，和它们为了获得奖励的情况类似。

举个例子，假设BIG COMPANY有50个验证人同时离线，从而导致由于验证人的无响应对其提名人进行1%的削减。在这个例子中,提名人提名5个验证人,有2个是属于BIG_COMPANY(BC_1 and BC_2),其他3个验证人,不属于BIG_COMPANY(OV_1、OV_2和OV 3)。在这个era阶段,BC_1是这个提名人的活跃验证人,BC_2和OV_1是不活跃的,OV_2和OV_3在等待。提名人将被削减1%的绑定金额，因为BC_1是活跃的验证人。不活跃和等待的验证人(BC_2和OV_1到3)对此没有任何影响，因为它们没有活跃地验证。任何活跃地提名BC_2的提名人也会被削减1%，但任何提名OV_1的提名人不受影响。

在极少数情况下，一个提名人可能会在一个时间间隔内活跃地提名几名验证人。在这种情况下，削减金额与特定验证人质押金额数量成比例。例如，如果一位提名人将其50%的质押分给BC_1和OV_1，他们将获得0.5%的大幅削减(1%的50%)。如果一个提名人活跃地提名BC_1和BC_2，同样将他们50%的质押分配给每个人，他们仍然会以1%的削减结束，因为1%的削减适用于他们的一半质押。请注意，您不能控制分配给每个验证人的份额百分比，也不能选择您的活动验证人是谁(除了在提名单个验证人的部分情况下)。质押的分配由[Phragmén算法](https://wiki.polkadot.network/docs/learn-phragmen)控制。

一旦验证人被削减资金，它就进入“未实施的削减”状态。你可以通过[Polkadot-JS](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Frpc.polkadot.io#/staking/slashes)应用程序检查这一点。UI界面会显示每个验证人，然后显示所有受影响的提名人以及金额。在未被实施的时候，可以在这个阶段(kusama7天，polkadot28天)，提出撤销的治理提案。但是在宽限期之后，就会进行削减。

以下是冒犯规则的级别[定义](https://research.web3.foundation/en/latest/polkadot/slashing/amounts.html)。然而，这些特定的级别并没有在代码或系统中实现或引用;它们是针对不同严重程度的违反行为的指导方针。要了解斜杠金额是如何计算的，请参阅下面一节中的公式。

- 第1级:孤立无响应，即在整个[时期](https://wiki.polkadot.network/docs/glossary#epoch)内处于离线状态。一般不削减，只是[冻结](https://wiki.polkadot.network/docs/learn-staking#chilling)。
- 第2级:并发无响应或单独地模棱两可。削减少量的质押金额，然后冻结。
- 第3级:不太可能发生意外，但不会对网络安全造成很大程度的损害。例子包括在[Grandpa](https://wiki.polkadot.network/docs/learn-consensus)选举中同时出现的模棱两可或不公正投票的单独案例。削减少量金额，然后冻结。
- 第4级:对系统造成严重安全或货币风险的不当行为，或大规模共谋。将验证人的所有或大部分质押资金进行削减，然后冻结。

让我们更详细地看看这些违规行为。

### 无响应
对于每个会话，验证人都会发送一个“我在线”的信号来表明他们是在线的。如果一个验证人在一个阶段期间没有产生任何块，并且没有发送心跳，那么它将被报告为无响应。削减就可能会发生，取决于重复的违规行为和有多少其他验证人在epoch期间没有响应或离线。

验证人应该有一个良好架构的网络基础设施，以确保节点运行，从而减少被削减或冻结的风险。高可用性设置是可取的，备份节点最好只在原始节点可验证脱机时才启动(以避免双重签名和因模棱两可而被削减—参见下面)。这里有一个关于验证人设置的全面指南。
以下是计算由于无响应而导致的削减的公式

> 设 x = 违规者数量, n = 活跃集中的验证人总数量    
min((3 * (x - (n / 10 + 1))) / n, 1) * 0.07

这些示例演示了如何计算无响应的大幅惩罚。
> 在所有示例中，假设活动集中有100个验证器。   

如果< 10%的验证人是无响应的，那么就没有必要进行削减。   
例如，如果确切10个验证人无反应，则表达式3（x-（n / 10 + 1）））/ n 为 3（10 - （100 /10 + 1）） / 100 = 3 *（10 - （（（（10 + 1）） / 100 = -0.03，舍入为0。
> 0和1之间的最小值为0。0乘以0.07等于0。

如果14个验证人没有响应，那么就会发生大幅削减，因为>10%的验证人没有响应。
削减处罚为 min（3（3（14 - （100 /10 + 1））） / 100，1）0.07 = min（（3（14-11）） / 100，1）0.07 = min（0.09，1） * 0.07 = 0.6％

同样，如果验证人集的三分之一（约33/100左右）无响应，则削减资金约为5％。

由于无响应而可能发生的最大削减为7％。大约45％的验证人离线后，表达式3（x-（n / 10 + 1））） / n将超出1。因此，（3（3（x - （n / 10 + 1））））/ n，1） * 0.07将被上升到7％。


### 模棱两可
GRANDPA模棱两可:一个验证人在不同的链上的同一轮次中签名啦两次或更多的投票。
BABE模棱两可：验证人在相同的时间间隙产生了两个或多个块中继链区块。

“GRANDPA”和“BABE”的模棱两可都使用相同的公式来计算大幅惩罚削减：    
>设 x = 违规者数量, n = 活跃集中的验证人总数量     
min( (3 * x / n )^2, 1)

例如，假设活跃集中有100个验证人，其中一个是在时间间隙中模棱两可（出于我们的目的，无论是BABE还是GRANDPA模棱两可，都没关系）。这种不太可能是对网络的攻击，但更有可能是验证人的配置错误。削减将为最小（3 * 1 /100）^2，1）= 0.0009，或该验证人池（即所有由验证人及其提名人持有的质押）
的0.09％

现在假设有一个组运行中的多个验证人，它们都在同一时间间隙中存在问题。削减金额为最小（（3 * 5/100）^2，1）= 0.0225，或2.25％。如果有20个验证人等同于更严重的违反规则，并且可能是对网络的共谋攻击，因此削减金额将更大，最小值（（3 * 20/100）^2，1）= 0.36或所有这些验证人及其提名人的36％。所有被削减的验证人也会被冻结。

从上面的例子可以看出，在活跃集中处于提名或运行许多验证人的风险是显而易见的。虽然奖励呈线性增长(两个验证人会让你获得大约两倍的单个质押收益)，但削减金额却是呈指数增长。一个验证人模棱两可会导致一个0.09%的削减，两个验证人模棱两可不会导致0.09 * 2 = 0.18%的削减，而是一个0.36%的削减，它是单个验证人的4倍。

验证人可能会在多台机器上运行它们的节点，以确保在其中一个节点发生故障时仍然可以执行验证工作，但验证人操作人员在设置这些节点时应该非常小心。如果他们没有很好的协调来管理签名机，模棱两可就可能发生，而模棱两可的行为比同等的掉线的行为会削减更多。

如果一名验证人被报告有任何违规行为，他们将被从验证人组中移除([冻结](https://wiki.polkadot.network/docs/learn-staking#chilling))，并且在他们被剔除的期间不会得到报酬。他们将被视为不活跃，并将失去他们的提名。他们需要重新发布验证意图并再次获得提名人的支持。

如果你想知道更多关于削减的细节，请查看我们的[研究页面](https://research.web3.foundation/en/latest/polkadot/slashing/amounts.html)。

### Chilling
“冻结”是指放弃任何提名或验证的行为。它可以在任何时候由验证人或提名人自己完成，在下一个阶段生效。它还特别意味着由另一个验证人将活跃的验证人集合中移除一个验证人，在下一个NPoS周期中取消它们在可选候选人集中被选举的资格。

冻结可能是自愿的，并且是由验证人发起的，例如，如果验证人所在的环境或托管提供商计划停机，验证人想退出以保护自己不被大幅削减。如果是自愿的，冻结将使验证人在当前会话中保持活跃，但在下一个会话中将它们移到不活动的集合。验证人不会失去他们的提名人。

当作为惩罚的一部分使用时(从外部发起)，被冻结会隐含着被取消提名的惩罚。它还在当前阶段的剩余时间内禁用验证人，并在下次选举中移除有问题的验证人。

波卡允许禁用一些验证人，但是如果禁用的验证人数量太大，波卡将触发一个新的验证人选举来获得完整的验证人集。被禁用的验证人将需要重新提交他们的验证意图，以验证和重新获得提名人的支持。

想要了解更多关于冷却的信息，请查看wiki上的[如何冷却页面](https://wiki.polkadot.network/docs/maintain-guides-how-to-chill)。


### 跨阶段削减    

在NPOS中削减存在3个主要困难：    

- 提名人可以提名多个验证人，并会由于其中任何一个被削减。
- 持续性的削减，质押会从一个阶段到另一个阶段重复使用。连续用N个代币在E个阶段提名并不意味着你有N*E个硬币可以削减——你只有N个。
- 可削减的违规行为可以在事后发现。

为了平衡这一点，我们只对参与者在某段时间内可以收到的最大削减进行削减运算，而不是总和。这确保了防止过度削减。同样地，计算最大削减的时间跨度是有限的，并且验证人会因为在一次大幅削减事件后提名被撤回而冻结，如上一节所述。这可以防止“愤怒退出”攻击，在这种攻击中，一旦被发现行为不当，参与者就会故意做出更多不当行为，因为他们的削减金额已经达到上限。

## 奖励分发
请注意，Kusama的运行速度约为Polkadot的4倍，除了块生产时间。Polkadot还将以大约六秒的间隔产生块。    
每次会话会记录奖励（大约在Kusama上为1小时，在Polkadot上为四个小时），并且每个阶段（在Kusama上大约六个小时，在Polkadot上为24小时会进行计算）。因此，奖励将在Kusama每天进行四次计算，每天在Polkadot上进行一次奖励。    
奖励是根据一个阶段的分数计算的，其中包含概率成分。换句话说，不同阶段的奖励可能会有细微的差异，甚至在同一时间活跃集的验证人之间也是如此。这些变化会在足够长的时间内相互抵消。关于这些如何计算的更多信息，请参阅[验证器支付指南](https://wiki.polkadot.network/docs/maintain-guides-validator-payout)的页面。

为了获得你的质押奖励，必须有人领取为提名验证人的奖励。质押奖励可以持续84个阶段，在Polkadot和kusama上大约是84天和21天。要了解更多关于为什么会这样的信息，请参阅关于[简单支付](https://wiki.polkadot.network/docs/learn-simple-payouts)的页面。

> 领取质押奖励：    
如果此时没有人认领你的质押奖励，那么你将无法认领，你的一些质押奖励将会丢失。此外，如果验证人解除了他们自己的所有质押，任何正在进行的支付都将丢失。由于在波卡解除质押需要28天的时间来约束，提名人应该至少经常检查他们是否有待支付的薪酬。

### 领取奖励
如果你去[Polkadot-JS](https://polkadot.js.org/apps/#/staking/payout)上的Staking payouts页面，你会看到一个列表，上面列出了你在过去的84个阶段中提名的所有验证人，以及还有你没收到付款。每个人都有选择触发支付所有无人认领的阶段。请注意，这将支付给那些阶段中提名验证人的每个人，任何人都可以调用它。因此，如果有人(通常，但不一定是另一个提名者或验证操作人员)在那个阶段触发了验证程序的支付，您可能在这个选项卡中看不到任何东西，但仍然收到了一笔支付。

如果您希望检查是否收到支付，您将必须通过区块浏览器检查。详情请参见[相关的支持](https://support.polkadot.network/support/solutions/articles/65000168954-how-can-i-see-my-staking-rewards-)页面。

### 奖励分发的例子
    PER_ERA * BLOCK_TIME = **Reward Distribution Time**
    3_600 * 6 seconds = 21_600 s = 6 hours

验证人可以创造一份不与提名人共享的奖励(提交区块的佣金)。这个分成是区块奖励的百分比，而不是绝对值。在扣除提交区块的佣金后，剩下的部分将基于他们的质押价值，并在验证人和投票给该验证人的所有提名人之间分配。

例如，假设验证人的区块奖励是10DOT。验证人可以指定`validator_commission = 50%`，在这种情况下，验证人将收到5个DOT。剩下的5个DOT将根据每个提名人的股份比例在验证人和他们的提名人之间分配。注意，验证人可以算进自己的质押，对于这个计算，他们的质押的行为就像他们是另一个提名者一样。

可以将奖励定向到同一帐户（控制账户），隐藏帐户（并增加固定值或不增加固定值）或完全无关的帐户。通过使用“交易选项”选项卡（`开发者 -> 交易 -> 质押 -> 绑定质押`），您也可以将奖励发送到“空”，有效地燃烧它们。也可以增加 /撤回一些质押，而不必取消所有质押。

关于验证器付款的具体细节，请参阅[本指南](https://wiki.polkadot.network/docs/maintain-guides-validator-payout)。

## 通胀
DOT是有通货膨胀的;没有最大数量的DOT。通货膨胀率被设计为每年大约10%，验证的奖励是质押的函数，其余的将进入国库。由于[重新计价](https://wiki.polkadot.network/docs/redenomination)，DOT目前的代币供应量约为10亿。

网络试图维持一个理想的质押率。目标是使系统的质押率达到理想的质押率。

系统质押率将是相对于总代币供应的总质押量，其中总质押量是网络上所有验证人和提名人的质押量。理想的质押率需要有足够的DOT支持，以防止安全性可能的妥协，同时保持原生代币的流动性。**50%的理想质押率可以稳定网络**。根据整个网络的系统质押率，DOT是膨胀的。

> 根据通货膨胀模型，这将表明，如果您不使用您的DOT进行质押，您的代币将随着时间的推移而被稀释。

Polkadot上的理想质押率也随平行链的数量而变化(50%是根据每个平行链插槽应该投注的金额以及所有DOT的估计)。

> 在没有平行链的情况下，由于流动性不受锁定平行链的约束，建议的理想质押率为75%。

如果质押的代币数量低于理想比率，那么对提名人的质押奖励就会上升。相反地，如果它高于此值，质押奖励就会下降。这是随上缴国库的质押奖励百分比变化。

![web3 research](https://cdn.jsdelivr.net/gh/VegeBun-csj/Images/w3f-research.png)
来源:[研究- Web3基金会](https://w3f-research.readthedocs.io/en/latest/polkadot/overview/2-token-economics.html)
- x轴:DOT占比
- y轴:通货膨胀，年化百分比
- 蓝线：通货膨胀给质押者的奖励
- 绿线:质押回报率

你可以通过查看[Polkadot-JS](https://polkadot.js.org/apps/#/staking)应用程序的质押概述来确定通货膨胀奖励。

上图显示了网络的通胀模型。根据质押参与的不同，通货膨胀向验证人/提名人与国库的分配将动态变化，以提供激励参与（或不参与）质押。

例如，假设理想的质押率为50％，如果将所有KSM / DOT的50％放置在验证人 /提名人中，所有通货膨胀率将归功于验证者 /提名人。与50％的任何偏差（正或负数）都将其剩余部分送到财国库，并有效地降低了质押奖励。

如果有兴趣了解更多关于网络膨胀模型的设计，请点击[这里](https://research.web3.foundation/en/latest/polkadot/overview/2-token-economics.html)。

### 为什么质押？
- 网络启动时的每年10％的通货膨胀
- 50％的目标质押率
- 大约20％的年收益率

到目前为止，网络一直遵循一个膨胀模型，该模型排除了活跃的平行链的度量。理想的质押率并不总是50%，因为活跃的平行链的数量会影响保证网络安全的可用流动性。

请记住，当系统的质押率低于理想的质押率时，年收益率将更高，鼓励更多的用户使用他们的代币进行质押。相反，当系统质押率高于理想投注率时，年收益率就会减少，从而鼓励部分用户退出。

### 为什么不质押
- 在波卡上，解除绑定质押后，代币将被锁定约28天，在Kusama上将被锁定7天。
- 验证人被发现行为不端时的惩罚(参见[#削减](https://wiki.polkadot.network/docs/learn-staking#slashing))。
- 您希望对平行链插槽使用代笔。

## 波卡有多少验证人？
波卡从20个公开的验证人席位开始，逐渐增加到297个。验证人数量的上限还没有确定，但应该只受点对点消息传递造成的网络带宽压力的限制。波卡在成熟时的验证人数量估计在1000个左右。波卡的金丝雀网络(Kusama)目前有900个验证人插槽。

## 资源
- [波卡上的提名权益证明是如何工作的](https://medium.com/web3foundation/how-nominated-proof-of-stake-will-work-in-polkadot-377d70c6bd43)- Web3基金会研究员Alfonso Cevallos在波卡报道的博客文章。
- [验证人设置](https://wiki.polkadot.network/docs/maintain-guides-secure-validator)













































