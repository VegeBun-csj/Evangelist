# Parachains
> 在Rococo上测试    
关于如何参与Rococo的众贷和平行链拍卖测试的信息，请参阅平行链开发指南上的[Rococo内容](https://wiki.polkadot.network/zh-CN/docs/build-pdk##testing-a-parachains:-rococo-testnet)。

平行链是一种特定于应用程序的数据结构，它们对于中继链的验证人来说是全局一致并且是可验证的。他们从平行于中继链的概念中取名。最常见的是平行链会采用区块链的形式，但没有具体的需要是实际的区块链。


由于它们的并行性，所以能够并行地处理事务，实现波卡系统的可伸缩性。它们共享整个网络的安全性，并可以通过XCM格式与其他平行链进行通信。

平行链由一个称为收集人节点的网络维护程序来维护。收集人节点的作用是维护平行链的完整节点，保留平行链的所有必要信息，并产生新的候选块来传递给中继链验证人节点，以便在波卡的共享状态下进行验证并包含在其中。收集人节点的激励是在平行链的实现细节。它们不需要在中继链上质押或拥有原生代币，除非平行链的实现有规定。

波卡宿主机(PH)需要平行链上执行的状态转换被指定为Wasm可执行文件。对于发生在平行链上的新的状态转换的证明，必须在确认状态转换发生之前，由中继链上的验证人根据已注册的状态转换函数(STF)进行验证。STF存储在中继链上。平行链逻辑的关键约束是，它必须由中继链的验证人验证。验证最常见的形式是状态转换的绑定证明，即一个POV区块，它由一个或者多个平行链的收集人提交给验证人进行核实。

## 平行链经济
平行链可能拥有自己原生代币的经济。像POS之类的方案通常用于选择验证人来处理验证并终结；这些都不需要平行链来完成。然而，由于波卡对平行链的实现并不是非常在意，所以平行链可以实现一个可质押的代币，但这通常不是必需的。

收集人可能会被本地平行链代币的通胀所激励，也可能还有其他方法来激励收集人节点，而不涉及通胀原生的平行链代币。

原生平行链代币中的交易费用也可以是平行链的选择实现。波卡对于平行链如何决定交易的原始有效性并没有制定严格的规则。例如，平行链可以实现为，交易必须向收集人支付最低费用才能有效。中继链会加强这种有效性。类似地，一个平行链没有包含这个实现，而波卡仍会加强它的有效性。

平行链不需要有自己的代币。如果他们这样做了，取决于平行链为他们的代币提出经济理由，而不是波尔。

## 平行链中继
尽管波卡可以在平行链之间启用跨链功能，但它在一个平行链发送消息，直到目的平行链收到消息时存在一定的延迟。在乐观的情况下，这个消息的延迟至少为两个区块 -一个块是调用消息，一个块用于接收平行链消息，从而处理并产生消息的发生作用的区块。但是，在某些情况下，我们可能会看到，如果队列中有许多待处理的消息，或者没有任何节点运行两个可以快速串通网络消息的平行链网络，那么消息的延迟会较高。

由于发送跨链消息会有一定的延迟，一些平行链计划成为整个行业的中心。例如，平行链项目[Acala](https://acala.network/)计划成为去中心化金融(DeFi)应用的中心。许多DeFi应用利用了一种称为可组合性的属性，可组合性意味着一个应用的功能可以与其他应用协同组合以创建新的应用。这方面的一个例子包括闪电贷款，它借入资金来执行一些链上逻辑，只要贷款在交易结束时得到偿还。

跨链延迟的一个问题是，与单个区块链相比，平行链之间的可组合性减弱。**这个含义对于所有的分片区块链设计都是通用的，包括波卡、以太坊2.0以及其他**。解决这个问题的方法是引入平行链中继，它保持了较强的单块可组合性。

## 平行链插槽的获取
波卡支持有限数量的平行链，目前估计大约有100个。由于插槽的数量是有限的，有以下几种方法来分配它们：
- 治理授权的平行链链，或“公益”平行链
- 拍卖授权的平行链
- 平行线程

[“公益”平行链](https://wiki.polkadot.network/zh-CN/docs/learn-parachains#common-good-parachains)由波卡的链上治理系统分配，它们被认为是网络的“公共利益”，比如作为连接其他网络或链的桥梁。通常被认为是系统级别的链或公用的链。它们通常没有一个经济模型，可以帮助从中继链上删除交易，使得更有效的平行链处理。

[拍卖授权的平行链](https://wiki.polkadot.network/zh-CN/docs/learn-auction)是在一个公开的拍卖中被授权的。平行链团队可以使用自己的DOT代币竞标，也可以使用[众贷功能](https://wiki.polkadot.network/zh-CN/docs/learn-crowdloans)从社区获取代币。

[平行线程](https://wiki.polkadot.network/zh-CN/docs/learn-parathreads)与平行链具有相同的API，但它的执行是以现收现付为基础，对每个区块进行拍卖。

### 插槽过期
当一个平行链赢得拍卖时，它投标的代币将被保留到租期结束。质押的金额是无法转账的，也不能用于质押。在租期结束时，代币会被解除质押。没有获得新租期的平行链将自动成为平行线程。

##公益平行链
“公益”平行链是为使整个生态系统受益的功能而保留的平行链插槽。通过将一组平行链插槽分配给公益平行链，整个网络可以获得这些有价值的平行链的好处，否则会由于搭便车问题，这些平行链会出现资金不足。它们不是通过平行链插槽拍卖分配的，而是通过链上[治理](https://wiki.polkadot.network/zh-CN/docs/learn-governance)系统分配的。一般来说，公益平行链的租期不会到期;只有通过治理才能消除它。

可以通过[波卡博客文章](https://polkadot.network/blog/common-good-parachains-an-introduction-to-governance-allocated-parachain-slots/)以及[公益平行链](https://wiki.polkadot.network/zh-CN/docs/learn-common-goods)来了解更多信息

## 例子
一些平行链的例子：
- 加密的联盟链：这些链可能是不向公众泄漏任何信息的私有链，但由于XCMP协议的性质，仍然可以与它们进行去信任的交互。
- 高频交易链：这些链可以通过进行某些权衡或进行优化，在短时间内计算大量交易。
- 隐私链：这些链通过使用新颖的加密技术，从而不向公众泄露任何信息。
- 智能合约链：这些链可以通过部署智能合约代码并在其上实现额外的逻辑。

## FAQ
### 什么是“平行链共识”
“平行链共识”是特别的，因为它将遵循波卡中继链。平行链不能使用其他具有自身终结性的共识算法。只有主权链(必须通过平行链桥接到中继链链)才能决定自己的共识。平行链决定了如何编写代码以及由谁编写代码。波卡保证有效的状态转换。在中继链的上下文之外执行一个块终结性会超出了波卡提供的信任范围。

`不是基于Substrate构建的平行链呢？`   
Substrate提供了FRAME Pallets作为其框架的一部分，从而实现无缝地构建基于Rust的区块链。FRAME的一部分是Pallet，从而用于共识。波卡作为一个基于Substrate的链，依赖于BABE作为区块产生的方案，而GRANDPA作为其共识机制最终完结性的一部分。总的来说，这是一个[混合共识模型](https://wiki.polkadot.network/zh-CN/docs/learn-consensus#hybrid-consensus)，其中块的产生和块的终结是分开的。平行链只需要生成块，因为它们可以依赖于中继链来验证状态转换。因此，平行链可以自己产生区块，其中收集人是作为区块的生产者，尽管平行链不是基于Substrate构建的。

### 平行链的插槽如何分配？
平行链槽可以通过拍卖获得，请参阅[平行链槽](https://wiki.polkadot.network/zh-CN/docs/learn-auction)的文章。此外，一些平行链插槽将被留出来运行平行线程，它们会以每个区块为基础进行投标，以被包含在中继链中。

### 当验证人的数量低于某个阈值时，平行链会发生什么?
每个平行链的验证人的最小安全比率为5：1。借助足够大的验证人集合，其分布的随机性以及[可用性和有效性](https://wiki.polkadot.network/zh-CN/docs/learn-availability)将确保安全性。但是，如果有大量云提供商或其他网络连接性灾难发生，则可以合理地预期每个链的验证人数量会减少。

根据有多少验证人离线，结果会有所不同。

如果有几个验证人离线，那些验证器集合太小而无法验证一个块的平行链将跳过这些块。它们的块生产速度将增加6秒，直到问题解决，即最佳的验证人数量再次出现在该平行链的验证人组中。

如果有30%到50%的验证人离线，可用性将受到影响，因为我们需要设置三分之二的验证器来支持平行链的候选区块。换句话说，所有的平行链将停止，直到问题得到解决。区块终结性也会停止，但是中继链上的低价值交易可以足够安全地执行，尽管会有常见的分叉。一旦所需的验证器数量再次进入验证器集，p平行链将恢复生产区块。

考虑到收集人是他们正在运行的中继链和平行链的完整节点，他们能够在中断发生时识别出中断，并且应该停止产生候选块。同样，他们应该很容易识别什么时候可以安全重启生产区块——可能是基于终结性延迟、验证器集大小或其他一些在[Cumulus](https://github.com/paritytech/cumulus)尚未确定的因素。

## 平行链开发工具集
平行链开发工具集是一组工具，允许开发人员将自己的应用程序创建为平行链。有关更多信息，请参阅[PDK内容](https://wiki.polkadot.network/zh-CN/docs/build-pdk#parachain-development-kit-pdk)。

## 资源
- [波卡：平行链](https://medium.com/polkadot-network/polkadot-the-parachain-3808040a769a) -波卡的联合创始人Rob Habermeier在2017年发表的平行链博客文章，他将平行链作为“区块链的一种更简单的形式，它连接到中继链，中继链提供了安全性，而不是自己提供安全性。”中继链为附加的平行链提供了安全性，也为它们之间的安全消息传递提供了保证。
- [平行链区块的历程](https://polkadot.network/the-path-of-a-parachain-block/) - 平行链与中继链相互作用的历程。




















